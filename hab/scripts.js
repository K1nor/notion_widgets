document.addEventListener('contextmenu',e=>e.preventDefault());window.addEventListener('DOMContentLoaded',()=>{function getCurrentDateGMT5(){const now=new Date(),utc=now.getTime()+now.getTimezoneOffset()*6e4,gmt5=new Date(utc+5*36e5);return gmt5.toISOString().split('T')[0]}const lastReset=localStorage.getItem('lastResetDate'),today=getCurrentDateGMT5();if(lastReset!==today){localStorage.setItem('pomodoro-work-index','0');localStorage.setItem('pomodoro-hobby-index','0');document.querySelectorAll('.schedule-block .task-item').forEach((_,i)=>localStorage.removeItem('schedule-task-'+i));localStorage.setItem('lastResetDate',today)}const workBlock=document.querySelector('.pomodoro-block .work'),hobbyBlock=document.querySelector('.pomodoro-block .hobby'),workTasks=Array.from(workBlock.querySelectorAll('.task-item')),hobbyTasks=Array.from(hobbyBlock.querySelectorAll('.task-item'));let workIndex=parseInt(localStorage.getItem('pomodoro-work-index'),10)||0,hobbyIndex=parseInt(localStorage.getItem('pomodoro-hobby-index'),10)||0;workTasks.forEach((t,i)=>i<workIndex&&t.classList.add('completed'));hobbyTasks.forEach((t,i)=>i<hobbyIndex&&t.classList.add('completed'));workBlock.addEventListener('click',()=>{if(workIndex<workTasks.length){workTasks[workIndex].classList.add('completed');localStorage.setItem('pomodoro-work-index',++workIndex)}});hobbyBlock.addEventListener('click',()=>{if(hobbyIndex<hobbyTasks.length){hobbyTasks[hobbyIndex].classList.add('completed');localStorage.setItem('pomodoro-hobby-index',++hobbyIndex)}});workBlock.addEventListener('contextmenu',e=>{e.preventDefault();if(workIndex>0){localStorage.setItem('pomodoro-work-index',--workIndex);workTasks[workIndex].classList.remove('completed')}});hobbyBlock.addEventListener('contextmenu',e=>{e.preventDefault();if(hobbyIndex>0){localStorage.setItem('pomodoro-hobby-index',--hobbyIndex);hobbyTasks[hobbyIndex].classList.remove('completed')}});document.querySelectorAll('.schedule-block .task-item').forEach((task,i)=>{if(localStorage.getItem('schedule-task-'+i)==='true')task.classList.add('completed');task.style.cursor='pointer';task.addEventListener('click',()=>{task.classList.toggle('completed');localStorage.setItem('schedule-task-'+i,task.classList.contains('completed'))})});(function(){const now=new Date(),utcNow=now.getTime()+now.getTimezoneOffset()*6e4,ms=864e5,g5=utcNow+5*36e5,days=Math.floor(g5/ms),nr=(days+1)*ms,nl=nr-5*36e5-now.getTimezoneOffset()*6e4,delay=nl-now.getTime();setTimeout(()=>location.reload(),delay)})()});